===================================================================================
                 Repast HPC Version 1.0.1 Final Release Notes

===================================================================================
New Features
===================================================================================
Repast HPC

* Efficient Random Selection of Agents by User-Specified Criteria
* Cancellation of Agent Requests
* Command Line Arguments Supersede Properties Files/ Properties Outputs
* Compatibility with Most Recent versions of Boost
* Compatibility with Most Recent XL and GCC compilers

===================================================================================
Enhancements
===================================================================================
Repast HPC

* Sender/Receiver Management Uses MPI AllToAll
* Properties Files read only by process 0
* AgentRequests and Shared Network Functions now use MPI AllToAll
* Data set constructors automatically adjust suffix for duplicate filenames
* Random number generation now varies seed across processes (repeatably)
* Can be run in sub-communicator (does not rely on 'world')

ReLogo

* Setup method of Observer child class need no longer invoke parent explicitly

===================================================================================
Bug Fixes
===================================================================================
Repast HPC

* GetDisplacement now returns Displacement from P1 to P2 instead of P2 to P1
* Nonblocking sends now wait until status is complete
* "Importers" data structure now cleared after use
* Non-Toroidal Space no longer causes null pointer exception

ReLogo

* Create Networks using SimRunner/Properties File
* withMax function now corrected
* repast::BaseGrid::GetDisplacement fix also corrects multiple relogo functions
* Selection from agent sets by values chooses randomly from identical values

Rumor Model

* Replaced set<Node*> with explicit comparison operator, allowing Random Number
   Seed level reproducibility.
* Now can be used in subcommunicator

Zombies Demo

* Observer::setup signature corrected



***********************************************************************************
*                                 Details                                         *
***********************************************************************************


===================================================================================
RepastHPC
===================================================================================
* Efficient Random Selection of Agents by User-Specified Criteria

New functions of the Context and SharedContext classes allow the random
selection of sets of agents; the methods use optional arguments to provide the
following syntax:

  selectAgents  [count] (set | vector) [type] [filter] [remove = false [popSize]]

Where:

   count: the number of agents to be selected. 
   (set | vector): either a set or a vector must be passed; this will be a
        std::set<Agent*> or a std::vector<Agent*>. If a vector is passed, 
        the results will be shuffled before being returned. Whichever 
        collection is used, if it is not empty then any agents already in the 
        collection will not be selected from the population. 
   type: an integer representing agent type (as per its AgentId); if included, 
        only agents of this type will be selected
   filter: a user-defined struct that takes a boost pointer to an agent and 
        returns 'true' or 'false' based on some criteria (see 'IsLocalAgent' 
        for an example).
   remove: if this is set to 'true', the agents present in the set or vector 
        passed will be removed from the set or vector that is returned. If false 
        (the default), the set returned will contain all of the agents 
        selected plus all of the agents that were originally in the set
   popSize: If a value is given, the routine assumes that the number of agents 
        in the source population is known and need not be calculated again. 
        Counting the number of agents in a given iterator is slow and should be 
        avoided if possible.

For SharedContext, an additional parameter can be provided that indicates whether
only local or only non-local agents should be selected

===================================================================================
* Cancellation of Agent Requests

In previous releases, once an agent was requested, its information would be 
exported to the requesting process until the end of the simulation. Now agent
requests can be cancelled, which will stop the agent's information being sent.

===================================================================================
* Command Line Arguments Supersede Properties Files/ Properties Outputs

Command line arguments in the form "Property=Value" can be passed to models and
supersede properties with the same key specified in the model's properties
file. This provides an easy way to store default values in the properties file
but easily perform runs using different values. Values in Properties objects
can now be written directly to logs or to separated value files.

===================================================================================
* Compatibility with Most Recent versions of Boost

Repast HPC has been run with Boost versions 1.46, 1.47 and 1.48

===================================================================================
* Compatibility with Most Recent XL and GCC compilers

An adjustment in the configure script now allows installation using the most
recent version of the gcc compiler. The compatibility with XL is unchanged.

===================================================================================
* Sender/Receiver Management Uses MPI AllToAll

The 'SRManager' class, previously defined in mpiio.h, is replaced. The function of
the class is to send integers from each process to each other process, indicating
the number of elements each process will request from each other process. The new
implementation uses MPI Alltoall, with a significant performance increase.

===================================================================================
* Properties Files read only by process 0

Users can optionally configure their models so that both the model 'Properties'
and 'Configuration' files are read only on process 0 and broadcast to the other
ranks. This avoids collisions among N processes trying to read a single file
simultaneously. This is optional because it occurs during initialization, often 
before processes are synchronized, and so may not carry a performance benefit in
all contexts. However, at large scales, it is probably preferable.

===================================================================================
* AgentRequests and Shared Network Functions now use MPI AllToAll

Agent Requests and some functions of Shared Networks were previously processed 
by sending all request through process 0, which then collated and 
redistributed them. The new implementation executes the initial sort in parallel 
on all origin processes, then uses MPI Alltoall to exchange the requests. This 
carries a significant performance improvement.

===================================================================================
* Data set constructors automatically adjust suffix for duplicate filenames

In the previous release, a simulation run that attempted to create a data set
with the name of a pre-existing file would rename the existing file, and
mark it with a current time stamp. This led to the counterintuitive case where
simulations run previously had their data files re-named using newer timestamps.
The new implementation will not overwrite or change an existing file, but instead
will add a timestamp suffix to the name of the new file being created.

===================================================================================
* Random number generation now varies seed across processes (repeatably)

Repast HPC allows a simulation run to be replicated by providing the original
random number seed. However, When a RNS is provided to the previous implementation,
all processes initialized their random number generation engine using the same seed.
This led to a situation where all processes performing similar operations- such
as selecting sets of agents- would select essentially duplicate sets. The new
release uses the specified RNS on process 0 to generate seeds that are distributed
to the other processes.

===================================================================================
* Can be run in sub-communicator (does not rely on 'world')

Instances in the original code that referred to default global MPI communicator are
replaced; RepastProcess can be initialized with a communicator that is passed or
made available to all functions. This means that a job running on a large machine
can govern multiple, separate RepastHPC jobs, each running in its own communicator.

===================================================================================
* Setup method of Observer child class need no longer invoke parent explicitly

Previously the user was required to create a child class of 'Relogo::Observer'
and provide it with a'Setup' method; an additional requirement was that this
user-defined 'Setup' method would, as its first action, invoke the 'Setup' method
of the parent class. This has been refactored; the user-defined 'Setup'
method is now called internally after the parent class's method is automatically
invoked.

===================================================================================
* GetDisplacement now returns Displacement from P1 to P2 instead of P2 to P1

Although the method could have been correct either way, usage at other places
in the RepastHPC and Relogo code indicated that the correct result for this
function should be the displacement from P1 to P2, and not from P2 to P1. This
has been adjusted, with implications for other functions on which it depends
(see below).

===================================================================================
* Nonblocking sends now wait until status is complete

In pure MPI, a non-blocking send (one that allows code execution to continue even
before the communication is complete) requires that the buffer that contains the
information being sent be kept intact until the send is finished as indicated by
the appropriate status flag. In practice, implementations of MPI are allowed to
alter the strategy for the send in ways that might make this irrelevant- such as
by immediately copying the buffer or object to be sent. In the original RepastHPC
code there were multiple places where the buffer or object being sent was allowed
to fall out of scope before the status of the send was checked. In practice, no
error was ever caused by this, but to conform to the written specification, these
instances have been changed to protect the buffer until the send is confirmed
complete.

===================================================================================
* "Importers" data structure now cleared after use

In RepastProcess, a data structure used to specify data as part of exchanging
agents was never cleared, leading potentially to redundant data sends. This has
been fixed in the current release.

===================================================================================
* Non-Toroidal Space no longer causes null pointer exception

A search by one process for pointers to space elements representing spaces 
manageed by neighboring processes caused a null pointer
exception when a process did not have neighbors in all directions; this was
never the case for toroidal spaces, but for non-toroidal spaces processes at the
boundaries would have no neighbors. The null pointer is now trapped.

===================================================================================
ReLogo
===================================================================================
* Create Networks using SimRunner/Properties File

The original release of Repast HPC omitted a way to specify that one or more
networks should be created for use in Relogo models. In the new release, entries
in the properties file can specify that one or more directed or undirected networks
should exist with the specified names.


===================================================================================
* withMax function now corrected

The original implementation worked correctly only for sets in which all values
were greater than zero; the new implementation corrects this.

===================================================================================
* repast::BaseGrid::GetDisplacement fix also corrects multiple relogo functions

Functions affected by the correction to BaseGrid::GetDisplacement include:

	moveTiedTurtles
		This is also is called by:
			 move
	towards(Point)
		This is called by:
			towards (RelogoAgent)
			towardsxy(double, double)
			moveTiedTurtles
			face(Turtle)
			face(Patch)
			facexy(double, double)

===================================================================================
* Selection from agent sets by values chooses randomly from identical values

Relogo's minNOf and maxXOf functions are intended to allow a user to specify
a way to retrieve a specific property from each of a set of agents and a way to 
retrieve the N agents with the lowest or highest values of that property. The
original implementation performed a simple sort and returned the first N values
from the resulting list. However, in cases where 'ties' can occur, selection
from the valid candidates should be randomized (and integrated with the native
 random engine). An example would be a case in which N = 5 and the smallest
values retrieved are:  0, 0, 1, 2, 2, 2, 2, 2, 3 â€¦; in this case, the two agents
with '0' and the one with '1' should be returned, but the choice among the
5 possible agents with '2' should be mathematically random. This is now 
implemented.

===================================================================================
Rumor Model

* Replaced set<Node*> with explicit comparison operator, allowing Random Number
   Seed level reproducibility.

The basic data structure for the Rumor Model was a set of pointers to Node
objects. The std::set<Node*> object ordered nodes by value of the pointer, and
hence by address in memory where the node was created. This was not consistently
replicable. Added an explicit Node* comparison operator 'Node_Less', and created
std::set<Node*, NodeLess> that uses it; comparison is based on AgentId. There is
possibly a performance cost for this; compile using either with or without the
comparison struct to assess.

* Now can be used in subcommunicator

All references to boost::mpi::communicator default constructor (accessing
MPI_World) are replaced with calls to RepastProcess::instance()->getCommunicator(),
allowing model to use common communicator and be run in subcommunicator if needed.


===================================================================================
Zombies Demo

===================================================================================
* Observer::setup signature corrected

The signature of the setup method for the ZombieObserver class was incorrect; the
correct signature is: void ZombieObserver::setup(Properties& props), using
a reference for the properties object instead of an instance. Note that on many
systems this compiled and ran successfully; however, on the Intel compiler
it did not.

